"use strict";(self.webpackChunklumos_data_platform=self.webpackChunklumos_data_platform||[]).push([[290],{48720:function(on,At,i){i.r(At),i.d(At,{default:function(){return Xr}});var ar=i(19632),Et=i.n(ar),sr=i(15009),A=i.n(sr),ir=i(99289),re=i.n(ir),ur=i(5574),S=i.n(ur),or=i(97131),kt=i(45412),Pt=i(92016),C=i(45360),Tt=i(40411),fe=i(4393),ze=i(26412),xe=i(71230),B=i(15746),n=i(67294),ve=i(74250);function lr(){return ht.apply(this,arguments)}function ht(){return ht=re()(A()().mark(function g(){return A()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,Pt.request)("/api/profile/basic"));case 1:case"end":return a.stop()}},g)})),ht.apply(this,arguments)}function ln(){return gt.apply(this,arguments)}function gt(){return gt=_asyncToGenerator(_regeneratorRuntime().mark(function g(){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",request("/api/v1/status"));case 1:case"end":return a.stop()}},g)})),gt.apply(this,arguments)}function cn(){return pt.apply(this,arguments)}function pt(){return pt=_asyncToGenerator(_regeneratorRuntime().mark(function g(){return _regeneratorRuntime().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",request("/test/api/v0/data",{method:"GET"}));case 1:case"end":return a.stop()}},g)})),pt.apply(this,arguments)}function dn(g){return mt.apply(this,arguments)}function mt(){return mt=_asyncToGenerator(_regeneratorRuntime().mark(function g(r){var a,l,y,j;return _regeneratorRuntime().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,request("http://127.0.0.1:8000/api/v0/hdf5/list",{method:"GET",params:{current:(a=r==null?void 0:r.current)!==null&&a!==void 0?a:1,pageSize:(l=r==null?void 0:r.pageSize)!==null&&l!==void 0?l:10,keyword:(y=r==null?void 0:r.keyword)!==null&&y!==void 0?y:""}});case 2:return j=c.sent,c.abrupt("return",j);case 4:case"end":return c.stop()}},g)})),mt.apply(this,arguments)}function fn(g){var r=encodeURIComponent(g);return"http://127.0.0.1:8000/api/v0/hdf5/download?name=".concat(r)}function vn(){return St.apply(this,arguments)}function St(){return St=_asyncToGenerator(_regeneratorRuntime().mark(function g(){var r;return _regeneratorRuntime().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,request("/config.json",{method:"GET"});case 2:return r=l.sent,l.abrupt("return",r);case 4:case"end":return l.stop()}},g)})),St.apply(this,arguments)}var cr=i(9783),yt=i.n(cr),dr=i(28846),fr=(0,dr.kc)(function(g){var r=g.token;return{title:{marginBottom:"16px",color:r.colorTextHeading,fontWeight:"500",fontSize:"16px"},headerInfo:yt()({position:"relative",textAlign:"center","& > span":{display:"inline-block",marginBottom:"4px",color:r.colorTextSecondary,fontSize:r.fontSize,lineHeight:"22px"},"& > p":{margin:"0",color:r.colorTextHeading,fontSize:"24px",lineHeight:"32px"},"& > em":{position:"absolute",top:"0",right:"0",width:"1px",height:"56px",backgroundColor:r.colorSplit}},"@media screen and (max-width: ".concat(r.screenSM,"px)"),{marginBottom:"16px","& > em":{display:"none"}}),linearGradientButton:{"> span":{position:"relative"},"&::before":{content:"''",background:"linear-gradient(135deg, #6253e1, #04befe)",position:"absolute",inset:"-1px",opacity:1,transition:"all 0.3s",borderRadius:"inherit"},"&:hover::before":{opacity:0}},loadingMask:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"white",textAlign:"center"}}}),Ct=fr,vr=i(97857),He=i.n(vr),hr=i(4913),gr=i(60933),e=i(85893),pr=function(r){var a=r.color,l=a===void 0?16711680:a,y=r.shaftRadius,j=y===void 0?.003:y,b=r.shaftLength,c=b===void 0?.07:b,D=r.headRadius,Z=D===void 0?.005:D,L=r.headLength,Q=L===void 0?.03:L,I=r.opacity,z=I===void 0?0:I,se=c+Q;return(0,e.jsxs)("group",{rotation:[Math.PI/2,0,0],children:[(0,e.jsxs)("mesh",{position:[0,c/2,0],children:[(0,e.jsx)("cylinderGeometry",{args:[j,j,c,32]}),(0,e.jsx)("meshBasicMaterial",{color:l,transparent:!0,opacity:z,side:ve.ehD})]}),(0,e.jsxs)("mesh",{position:[0,c+Q/2,0],children:[(0,e.jsx)("coneGeometry",{args:[Z,Q,32]}),(0,e.jsx)("meshBasicMaterial",{color:l,transparent:!0,opacity:z,side:ve.ehD})]})]})},Zt=pr,mr=(0,n.memo)(function(g){var r=g.pose,a=g.color,l=g.opacity;return(0,e.jsx)("group",{position:r.position,quaternion:r.quaternion,scale:.9,children:(0,e.jsx)(Zt,{color:a,shaftRadius:.003,shaftLength:.07,headRadius:.005,headLength:.03,opacity:l})})}),Sr=mr,yr=function(r){var a=r.currentPose,l=r.history,y=r.trajectoryLength,j=(0,n.useRef)(null),b=new ve.Ilk(16711680),c=1;return(0,n.useEffect)(function(){!a||!j.current||(j.current.position.copy(a.position).multiplyScalar(c),j.current.quaternion.copy(a.quaternion))},[a]),(0,e.jsxs)(gr.Xz,{camera:{position:[.25,.25,.5],fov:70},gl:{preserveDrawingBuffer:!0},children:[(0,e.jsx)("ambientLight",{intensity:.6}),(0,e.jsx)("directionalLight",{position:[10,10,5],intensity:1,castShadow:!0}),(0,e.jsx)("gridHelper",{args:[5,50]}),(0,e.jsx)("axesHelper",{args:[5]}),l.map(function(D,Z){console.log(Z);var L=(Z+1)/Math.min(l.length,y),Q=b.clone().multiplyScalar(L),I=.2+L*.8,z=He()(He()({},D),{},{position:new ve.Pa4().copy(D.position).multiplyScalar(c)});return(0,e.jsx)(Sr,{pose:z,color:16711680,opacity:I},"history-arrow-".concat(Z))}),a&&(0,e.jsxs)("group",{ref:j,children:[(0,e.jsx)("axesHelper",{args:[.1]}),(0,e.jsx)(Zt,{color:16711680,shaftRadius:.003,shaftLength:.07,headRadius:.005,headLength:.03})]}),(0,e.jsx)(hr.z,{enableDamping:!0,dampingFactor:.05,enableZoom:!0,enablePan:!0})]})},Lt=yr,ne={wrapper:"wrapper___PkEK_",listContainer:"listContainer___o7zbn",itemContainer:"itemContainer___AKCPD",selected:"selected___sbaet",itemTitle:"itemTitle___AiHnz",itemDesc:"itemDesc___Ww6vs",itemImgWrap:"itemImgWrap___IE41u",disabled:"disabled___lQ3Ok",itemImg:"itemImg___Z7aws",itemInfo:"itemInfo___cRBoQ",selectedMarker:"selectedMarker___wDF94",scaleIn:"scaleIn___DodMH"},Cr=i(93967),jr=i.n(Cr),V=function(g){return g.Portable="Portable",g.FullFunction="FullFunction",g}({}),br=i.p+"static/fastumipro1.5cbb908d.png",Fr=i.p+"static/product-full.f87f1597.png",It=[{title:"\u4FBF\u643A\u7248\u672C",description:"\u4FBF\u643A\u7248\u672C",url:br,value:V.Portable,apiBasePrefix:"/portable"},{title:"\u5168\u529F\u80FD\u7248\u672C",description:"\u5168\u529F\u80FD\u7248\u672C",url:Fr,value:V.FullFunction,apiBasePrefix:"/pro"}],Br=function(r){var a=r.value,l=a===void 0?V.Portable:a,y=r.onChange,j=r.disabled,b=function(D){j||y&&y(D)};return(0,e.jsx)("div",{className:ne.wrapper,children:(0,e.jsx)(fe.Z,{style:{marginTop:0},title:"\u7248\u672C\u9009\u62E9",children:(0,e.jsx)("div",{className:ne.listContainer,children:It.map(function(c){var D=l===c.value;return(0,e.jsxs)("div",{className:jr()(ne.itemContainer,yt()(yt()({},ne.selected,D),ne.disabled,j&&!D)),onClick:function(){return b(c.value)},children:[(0,e.jsx)("div",{className:ne.itemImgWrap,children:(0,e.jsx)("img",{src:c.url,alt:c.title,className:ne.itemImg})}),(0,e.jsx)("div",{className:ne.itemInfo,children:(0,e.jsx)("h3",{className:ne.itemTitle,children:c.title})}),D&&(0,e.jsx)("div",{className:ne.selectedMarker})]},c.value)})})})})},xr=Br,Ot=(0,n.createContext)({}),Rr=Ot.Provider,hn=function(){return useContext(Ot)},wr=i(80882),Dr=i(48115),Ar=i(28280),Wt=i(18429),Er=i(36027),kr=i(9798),T=i(83622),Pr=i(83062),Nt=i(34041),Tr=i(96074),Ge=i(42119),Zr=i(85576),Lr=i(74330),Re={countdownWrapper:"countdownWrapper___qaa5S",numberWrapper:"numberWrapper___BduAc",animate:"animate___IOp3D",scaleAnimation:"scaleAnimation___PUFVj"},Ir=i(91742),Or=function(r){var a=r.totalSeconds,l=a===void 0?3:a,y=r.triggerCountdown,j=r.onComplete,b=r.showAnimation,c=b===void 0?!0:b,D=r.animationScale,Z=D===void 0?1.5:D,L=r.animationDuration,Q=L===void 0?.5:L,I=r.textColor,z=I===void 0?"#04befe":I,se=r.backgroundColor,ie=se===void 0?"rgba(255, 255, 255, 0.9)":se,we=r.showCircleBackground,ue=we===void 0?!0:we,Oe=(0,n.useState)(!1),J=S()(Oe,2),K=J[0],ae=J[1],We=(0,n.useState)(!1),me=S()(We,2),p=me[0],Se=me[1],Ne=(0,n.useState)(l),he=S()(Ne,2),q=he[0],ye=he[1],Ye=(0,n.useState)(),De=S()(Ye,2),Ce=De[0],Ae=De[1],E=(0,n.useRef)(l),_=(0,n.useRef)(null),Ve=(0,Ir.Z)({targetDate:Ce,onEnd:function(){j==null||j(),ae(!1),Se(!1)}}),Ee=S()(Ve,1),je=Ee[0];(0,n.useEffect)(function(){var P=Math.round(je/1e3);P!==E.current&&P>=0&&P<=l&&(ye(P),c&&_.current&&(_.current.classList.remove(Re.animate),_.current.offsetWidth,_.current.classList.add(Re.animate)),E.current=P)},[je,l,c]),(0,n.useEffect)(function(){y&&!K&&(ae(!0),Se(!0),ye(l),E.current=l,Ae(new Date().getTime()+l*1e3))},[y,K,l]);var oe=(0,n.useCallback)(function(){q===0&&_.current&&_.current.classList.add(Re.final)},[q]),ke=(0,n.useCallback)(function(P){return P===0?"Go!":P.toString()},[]),O=(0,n.useCallback)(function(){return q===0?"140px":"120px"},[q]),H=(0,n.useCallback)(function(){var P={};return z&&(P.color=z),ie&&ue&&(P.background=ie),P},[z,ie,ue]);return K?(0,e.jsx)("div",{className:Re.countdownWrapper,style:{backgroundColor:"rgba(0, 0, 0, 0.7)"},children:(0,e.jsx)("div",{ref:_,className:"".concat(Re.numberWrapper," ").concat(p?Re.animating:""),style:He()(He()({fontSize:O()},H()),{},{"--animation-scale":Z,"--animation-duration":"".concat(Q,"s")}),onAnimationEnd:oe,children:ke(q)})}):null},Wr=Or,Nr=i(96486),pe=i.n(Nr),Pe=kr.Z.Text,Mr="localhost",$r="8887",Ur="v0",jt="http://".concat(Mr,":").concat($r,"/api/").concat(Ur),Mt=5,Qr=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;return new Promise(function(a){setTimeout(function(){a(!0)},r)})},Te=function(r){var a=r.title,l=r.value,y=r.bordered,j=Ct(),b=j.styles;return(0,e.jsxs)("div",{className:b.headerInfo,children:[(0,e.jsx)("span",{children:a}),(0,e.jsx)("p",{children:l}),y&&(0,e.jsx)("em",{})]})},zr=function(r){var a=r.connect,l=r.connOk,y=r.version,j=r.isStarting,b=r.deviceStarted,c=r.recording,D=r.connMode,Z=r.leftSN,L=r.rightSN,Q=r.currentStep,I=r.setLeftSN,z=r.setRightSN,se=r.setRecording,ie=r.setConnect,we=r.setConnMode,ue=r.setVersion,Oe=r.setConnOk,J=r.setIsStarting,K=r.setDeviceStarted,ae=r.setCurrentStep,We=Ct(),me=We.styles,p=(0,n.useState)(!1),Se=S()(p,2),Ne=Se[0],he=Se[1],q=(0,n.useState)(""),ye=S()(q,2),Ye=ye[0],De=ye[1],Ce=(0,n.useState)(!1),Ae=S()(Ce,2),E=Ae[0],_=Ae[1],Ve=(0,n.useState)(!1),Ee=S()(Ve,2),je=Ee[0],oe=Ee[1],ke=(0,n.useState)(!1),O=S()(ke,2),H=O[0],P=O[1],ee=(0,n.useMemo)(function(){var f,h=(f=pe().find(It,{value:y}))===null||f===void 0?void 0:f.apiBasePrefix;return console.log("\u5F53\u524D\u7248\u672CAPI\u524D\u7F00\uFF1A",h),"".concat(jt).concat(h)},[y]),Me=function(){var f=re()(A()().mark(function h(){var v,s,m,t;return A()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,d.next=3,fetch("".concat(jt,"/pairing/config"),{method:"GET"});case 3:return v=d.sent,d.next=6,v.json();case 6:if(s=d.sent,console.log("\u52A0\u8F7D\u672C\u5730\u914D\u7F6E:",s),!(s!=null&&s.devices)){d.next=12;break}return I(((m=s.devices.device_0)===null||m===void 0?void 0:m.xv_serial)||""),z(((t=s.devices.device_1)===null||t===void 0?void 0:t.xv_serial)||""),d.abrupt("return",!0);case 12:return d.abrupt("return",!1);case 15:return d.prev=15,d.t0=d.catch(0),console.error("\u83B7\u53D6\u8BBE\u5907\u914D\u7F6E\u5931\u8D25:",d.t0),d.abrupt("return",!1);case 19:case"end":return d.stop()}},h,null,[[0,15]])}));return function(){return f.apply(this,arguments)}}(),Ke=function(){var f=re()(A()().mark(function h(){var v,s,m,t;return A()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,d.next=3,fetch("".concat(jt,"/status"),{method:"GET"});case 3:return v=d.sent,d.next=6,v.json();case 6:return s=d.sent,m=s.xv,t=s.device_version||"Unknown",t==="pro"?ue(V.FullFunction):t==="portable"&&ue(V.Portable),m==="RUNNING"?(K(!0),J(!1)):["STOPPED","CRASHED","STARTUP_FAILED"].includes(m)?(K(!1),J(!1)):m==="STARTING"&&(J(!0),K(!1),C.ZP.warning("\u8BBE\u5907\u542F\u52A8\u4E2D\uFF0C\u8BF7\u7A0D\u7B49\u540E\u5237\u65B0\u9875\u9762",3)),d.abrupt("return",!0);case 14:return d.prev=14,d.t0=d.catch(0),console.error("\u83B7\u53D6\u8BBE\u5907\u72B6\u6001\u5931\u8D25:",d.t0),d.abrupt("return",!1);case 18:case"end":return d.stop()}},h,null,[[0,14]])}));return function(){return f.apply(this,arguments)}}(),le=function(){var f=re()(A()().mark(function h(){var v,s;return A()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(ee){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,fetch("".concat(ee,"/recording/status"),{method:"GET"});case 5:if(v=t.sent,!v.ok){t.next=12;break}return t.next=9,v.json();case 9:s=t.sent,console.log("\u540C\u6B65\u5F55\u5236\u72B6\u6001:",s),s.is_recording!==void 0&&se(s.is_recording);case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(2),console.error("\u83B7\u53D6\u5F55\u5236\u72B6\u6001\u5931\u8D25:",t.t0);case 17:case"end":return t.stop()}},h,null,[[2,14]])}));return function(){return f.apply(this,arguments)}}();(0,n.useEffect)(function(){Me(),Ke(),le()},[]),(0,n.useEffect)(function(){b&&le()},[ee,b]);var bt=function(){var f=re()(A()().mark(function h(){var v,s,m,t,N,d;return A()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return P(!0),u.prev=1,u.next=4,fetch("".concat(ee,"/pairing/quick_run"),{method:"POST"});case 4:return v=u.sent,u.next=7,v.json();case 7:if(s=u.sent,!(!v.ok||!s.success)){u.next=10;break}throw new Error((s==null?void 0:s.message)||(s==null||(m=s.detail)===null||m===void 0?void 0:m.message)||"\u914D\u5BF9\u5931\u8D25");case 10:if(C.ZP.success(s.message||"\u914D\u5BF9\u6210\u529F\uFF01\u914D\u7F6E\u5DF2\u66F4\u65B0"),!s.data){u.next=16;break}I(((t=s.data.device_0)===null||t===void 0?void 0:t.xv_serial)||""),z(((N=s.data.device_1)===null||N===void 0?void 0:N.xv_serial)||""),u.next=18;break;case 16:return u.next=18,Me();case 18:u.next=27;break;case 20:return u.prev=20,u.t0=u.catch(1),C.ZP.warning("\u914D\u5BF9\u5F02\u5E38 (".concat(u.t0.message,")\uFF0C\u5C1D\u8BD5\u518D\u6B21\u52A0\u8F7D\u672C\u5730\u914D\u7F6E..."),3),u.next=25,Me();case 25:d=u.sent,d?C.ZP.success("\u5DF2\u52A0\u8F7D\u672C\u5730\u5386\u53F2\u914D\u7F6E"):C.ZP.error("\u65E0\u6CD5\u8FDE\u63A5\u670D\u52A1\u6216\u672C\u5730\u914D\u7F6E\u4E3A\u7A7A");case 27:return u.prev=27,P(!1),oe(!1),u.finish(27);case 31:case"end":return u.stop()}},h,null,[[1,20,27,31]])}));return function(){return f.apply(this,arguments)}}(),Je=function(){var f=re()(A()().mark(function h(){var v,s;return A()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(b){t.next=3;break}return C.ZP.warning("\u8BBE\u5907\u672A\u542F\u52A8\uFF0C\u65E0\u9700\u4E2D\u65AD",2),t.abrupt("return");case 3:return t.prev=3,C.ZP.loading("\u6B63\u5728\u53D1\u9001\u4E2D\u65AD\u6307\u4EE4\uFF0C\u6E05\u7406\u8FDB\u7A0B...",2),t.next=7,fetch("".concat(ee,"/device/stop"),{method:"POST"});case 7:return v=t.sent,t.next=10,v.json();case 10:if(s=t.sent,!v.ok){t.next=19;break}C.ZP.success("\u8BBE\u5907\u5DF2\u6210\u529F\u4E2D\u65AD\uFF1A".concat(s.message),3),ie(!1),K(!1),Oe(!1),we("idle"),t.next=20;break;case 19:throw new Error(s.detail||"\u4E2D\u65AD\u8BF7\u6C42\u88AB\u62D2\u7EDD");case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(3),C.ZP.error("\u8BBE\u5907\u4E2D\u65AD\u5931\u8D25\uFF1A".concat((t.t0===null||t.t0===void 0?void 0:t.t0.message)||t.t0),4);case 25:case"end":return t.stop()}},h,null,[[3,22]])}));return function(){return f.apply(this,arguments)}}(),qe=function(){var f=re()(A()().mark(function h(){var v,s;return A()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=3;break}return C.ZP.warning("\u8BF7\u5148\u65AD\u5F00\u8FDE\u63A5\u518D\u91CD\u542F\u8BBE\u5907",3),t.abrupt("return");case 3:return J(!0),t.prev=4,C.ZP.loading("\u6B63\u5728\u53D1\u9001\u542F\u52A8\u6307\u4EE4...",1),t.next=8,fetch("".concat(ee,"/device/start"),{method:"POST"});case 8:return v=t.sent,t.next=11,v.json();case 11:if(s=t.sent,!v.ok){t.next=17;break}C.ZP.success("\u6307\u4EE4\u53D1\u9001\u6210\u529F\uFF1A".concat(s.message||"\u6B63\u5728\u521D\u59CB\u5316..."),3),K(!0),t.next=18;break;case 17:throw new Error(s.detail||"\u542F\u52A8\u8BF7\u6C42\u88AB\u62D2\u7EDD");case 18:t.next=24;break;case 20:t.prev=20,t.t0=t.catch(4),C.ZP.error("\u542F\u52A8\u5931\u8D25\uFF1A".concat((t.t0===null||t.t0===void 0?void 0:t.t0.message)||t.t0),4),K(!1);case 24:return t.prev=24,J(!1),t.finish(24);case 27:case"end":return t.stop()}},h,null,[[4,20,24,27]])}));return function(){return f.apply(this,arguments)}}(),ge=(0,n.useMemo)(function(){return a?l?"\u5DF2\u8FDE\u63A5":"\u8FDE\u63A5\u4E2D\u2026":"\u672A\u8FDE\u63A5"},[a,l,D]),W=(0,n.useCallback)(function(){ie(!a)},[a]),ce=function(){var f=re()(A()().mark(function h(){var v,s;return A()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return he(!0),t.next=3,Qr(Mt*1e3);case 3:return console.log("\u5F00\u59CB\u91C7\u96C6\uFF1A",new Date().toLocaleTimeString()),t.prev=4,t.next=7,fetch("".concat(ee,"/recording/start"),{method:"POST"});case 7:return v=t.sent,t.next=10,v.json();case 10:s=t.sent,v!=null&&v.ok?(se(!0),C.ZP.success("\u5F00\u59CB\u91C7\u96C6\uFF0C\u6587\u4EF6\uFF1A".concat(s.message||""))):C.ZP.error("\u5F00\u59CB\u91C7\u96C6\u5931\u8D25"),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(4),C.ZP.error("\u5F00\u59CB\u91C7\u96C6\u5F02\u5E38\uFF1A".concat((t.t0===null||t.t0===void 0?void 0:t.t0.message)||t.t0));case 17:case"end":return t.stop()}},h,null,[[4,14]])}));return function(){return f.apply(this,arguments)}}(),_e=function(){var f=re()(A()().mark(function h(){var v,s,m,t,N,d;return A()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!E){u.next=2;break}return u.abrupt("return");case 2:return _(!0),u.prev=3,C.ZP.loading("\u6B63\u5728\u505C\u6B62\u91C7\u96C6\u5E76\u4FDD\u5B58\u6570\u636E...",2),u.next=7,fetch("".concat(ee,"/recording/stop"),{method:"POST"});case 7:return v=u.sent,u.next=10,v.json();case 10:s=u.sent,s.code===0?(se(!1),m=s.data||{},t=m.leftPath,N=m.rightPath,d=s.msg||"\u505C\u6B62\u6210\u529F",console.log("\u6570\u636E\u4FDD\u5B58\u8DEF\u5F84:",{leftPath:t,rightPath:N}),C.ZP.success("".concat(d))):C.ZP.error(s.msg||"\u505C\u6B62\u5F55\u5236\u5931\u8D25"),u.next=18;break;case 14:u.prev=14,u.t0=u.catch(3),console.error(u.t0),C.ZP.error("\u505C\u6B62\u8BF7\u6C42\u5F02\u5E38\uFF1A".concat((u.t0===null||u.t0===void 0?void 0:u.t0.message)||u.t0));case 18:return u.prev=18,_(!1),u.finish(18);case 21:case"end":return u.stop()}},h,null,[[3,14,18,21]])}));return function(){return f.apply(this,arguments)}}();(0,n.useEffect)(function(){var f=function(s){if(!(s instanceof HTMLElement))return!1;var m=s.tagName.toLowerCase();return m==="input"||m==="textarea"||s.isContentEditable},h=function(s){if(!s.repeat&&!f(s.target)){var m=s.key.toLowerCase();if(m===" "||m==="spacebar"){if(s.preventDefault(),E)return;a?a&&!c&&W():W()}if(m==="y"){if(E)return;a&&!c?ce():c&&_e()}}};return window.addEventListener("keydown",h),function(){window.removeEventListener("keydown",h)}},[a,c,E]);var et=(0,n.useState)(!1),tt=S()(et,2),be=tt[0],Ft=tt[1],rt=function(){return console.log("1. \u67E5\u770B\u8FDE\u63A5\u7684\u72B6\u6001")},Bt=function(){return console.log("2. \u542F\u52A8ROS")},nt=function(){return console.log("3. \u542F\u52A8xvisio")},xt=function(){return console.log("4. \u626B\u63CF\u53EF\u7528\u57FA\u7AD9")},at=function(){return console.log("5. \u6807\u5B9A")},Rt=function(){return console.log("6. \u53D1\u5E03\u57FA\u7AD9\u6570\u636E")},st=function(){return console.log("7. \u505C\u6389\u6240\u6709\u5305\u62ECROS\u670D\u52A1")},Ut=(0,n.useMemo)(function(){return y===V.FullFunction},[y]),it=function(){return null;switch(y){case V.FullFunction:return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(xe.Z,{gutter:[16,16],style:{marginTop:16},children:[(0,e.jsx)(B.Z,{span:6,children:(0,e.jsx)(T.ZP,{style:{width:"100%"},onClick:rt,children:"\u67E5\u770B\u8FDE\u63A5\u72B6\u6001"})}),(0,e.jsx)(B.Z,{span:6,children:(0,e.jsx)(T.ZP,{style:{width:"100%"},onClick:Bt,children:"\u542F\u52A8ROS"})}),(0,e.jsx)(B.Z,{span:6,children:(0,e.jsx)(T.ZP,{style:{width:"100%"},onClick:nt,children:"\u542F\u52A8xvisio"})}),(0,e.jsx)(B.Z,{span:6,children:(0,e.jsx)(T.ZP,{style:{width:"100%"},onClick:xt,children:"\u626B\u63CF\u53EF\u7528\u57FA\u7AD9"})}),(0,e.jsx)(B.Z,{span:6,children:(0,e.jsx)(T.ZP,{style:{width:"100%"},onClick:at,children:"\u6807\u5B9A"})}),(0,e.jsx)(B.Z,{span:6,children:(0,e.jsx)(T.ZP,{style:{width:"100%"},onClick:Rt,children:"\u53D1\u5E03\u57FA\u7AD9\u6570\u636E"})}),(0,e.jsx)(B.Z,{span:6,children:(0,e.jsx)(T.ZP,{danger:!0,style:{width:"100%"},onClick:st,children:"\u505C\u6389\u6240\u6709\u670D\u52A1"})})]})});case V.Portable:return(0,e.jsx)(e.Fragment,{});default:return(0,e.jsx)(e.Fragment,{})}},Qt=function(){switch(y){case V.FullFunction:return(0,e.jsx)(e.Fragment,{});case V.Portable:return(0,e.jsx)(e.Fragment,{});default:return(0,e.jsx)(e.Fragment,{})}};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Wr,{totalSeconds:Mt,triggerCountdown:Ne,onComplete:function(){he(!1)}}),(0,e.jsx)(fe.Z,{style:{marginTop:0},title:"\u64CD\u4F5C\u680F",extra:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Pr.Z,{title:be?"\u5C55\u5F00":"\u6536\u8D77",children:(0,e.jsx)(T.ZP,{type:"text",icon:be?(0,e.jsx)(wr.Z,{}):(0,e.jsx)(Dr.Z,{}),onClick:function(){return Ft(!be)}})})}),children:!be&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(xe.Z,{gutter:[48,24],children:[(0,e.jsxs)(B.Z,{lg:12,md:24,sm:24,xs:24,children:[(0,e.jsx)(Pe,{style:{display:"block",marginBottom:16,color:"rgba(0, 0, 0, 0.45)"},children:"\u6838\u5FC3\u64CD\u4F5C"}),(0,e.jsxs)(xe.Z,{gutter:[16,16],children:[(0,e.jsx)(B.Z,{span:12,children:b===!1?(0,e.jsx)(T.ZP,{type:"primary",icon:(0,e.jsx)(Ar.Z,{}),style:{width:"100%",background:"#52c41a",borderColor:"#52c41a"},onClick:qe,loading:j,disabled:a||c||E,children:"\u542F\u52A8\u8BBE\u5907"}):(0,e.jsx)(T.ZP,{danger:!0,type:"primary",icon:(0,e.jsx)(Wt.Z,{}),style:{width:"100%"},onClick:Je,disabled:c||E,children:"\u5173\u95ED\u8BBE\u5907"})}),(0,e.jsx)(B.Z,{span:12,children:a===!1?(0,e.jsx)(T.ZP,{type:"primary",icon:(0,e.jsx)(Er.Z,{}),className:me.linearGradientButton,style:{width:"100%",color:b?"#efefef":"#ffffff"},onClick:W,disabled:c||j||!b||E,children:"\u8FDE\u63A5\u8BBE\u5907"}):(0,e.jsx)(T.ZP,{danger:!0,type:"primary",icon:(0,e.jsx)(Wt.Z,{}),style:{width:"100%"},onClick:W,disabled:c||E,children:"\u65AD\u5F00\u8FDE\u63A5"})}),(0,e.jsx)(B.Z,{span:12,children:(0,e.jsx)(T.ZP,{type:"primary",style:{width:"100%"},onClick:ce,disabled:c||!a||E,children:"\u5F00\u59CB\u91C7\u96C6"})}),(0,e.jsx)(B.Z,{span:12,children:(0,e.jsx)(T.ZP,{danger:!0,style:{width:"100%"},onClick:_e,disabled:!c,loading:E,children:E?"\u4FDD\u5B58\u4E2D...":"\u505C\u6B62\u91C7\u96C6"})})]}),it()]}),(0,e.jsxs)(B.Z,{lg:12,md:24,sm:24,xs:24,children:[(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,e.jsx)(Pe,{style:{color:"rgba(0, 0, 0, 0.45)"},children:"\u8BBE\u5907\u914D\u7F6E"}),(0,e.jsx)(T.ZP,{type:"primary",size:"middle",ghost:!0,onClick:function(){return oe(!0)},disabled:a||c||!b||E,children:"\u270B\u{1F3FB} \u81EA\u52A8\u914D\u5BF9"})]}),(0,e.jsxs)(xe.Z,{gutter:[16,16],children:[(0,e.jsxs)(B.Z,{lg:12,md:12,sm:24,xs:24,children:[(0,e.jsx)(Pe,{strong:!0,children:"\u5DE6\u624B"}),(0,e.jsx)(Nt.Z,{style:{width:"100%",marginTop:8},placeholder:"\u9009\u62E9\u5DE6\u624B\u8BBE\u5907",showSearch:!0,allowClear:!0,disabled:!0,value:Z})]}),(0,e.jsxs)(B.Z,{lg:12,md:12,sm:24,xs:24,children:[(0,e.jsx)(Pe,{strong:!0,children:"\u53F3\u624B"}),(0,e.jsx)(Nt.Z,{style:{width:"100%",marginTop:8},placeholder:"\u9009\u62E9\u53F3\u624B\u8BBE\u5907",showSearch:!0,allowClear:!0,disabled:!0,value:L})]})]})]})]}),(0,e.jsx)(Tr.Z,{style:{marginTop:24,marginBottom:24}}),(0,e.jsxs)("div",{children:[(0,e.jsx)(Pe,{style:{display:"block",marginBottom:16,color:"rgba(0, 0, 0, 0.45)"},children:"\u72B6\u6001\u76D1\u63A7"}),(0,e.jsxs)(xe.Z,{gutter:[16,16],align:"top",children:[(0,e.jsx)(B.Z,{lg:9,md:24,sm:24,xs:24,children:(0,e.jsxs)(Ge.Z,{current:Q,size:"small",children:[(0,e.jsx)(Ge.Z.Step,{title:"\u672A\u8FDE\u63A5",description:"\u8BBE\u5907\u5DF2\u65AD\u5F00"}),(0,e.jsx)(Ge.Z.Step,{title:"\u5DF2\u8FDE\u63A5",description:"\u7B49\u5F85\u5F00\u59CB\u91C7\u96C6"}),(0,e.jsx)(Ge.Z.Step,{title:"\u91C7\u96C6\u4E2D",description:"\u6570\u636E\u6B63\u5728\u91C7\u96C6\u4E2D"})]})}),(0,e.jsx)(B.Z,{lg:3,md:8,sm:12,xs:24,children:(0,e.jsx)(Te,{title:"\u8FDE\u63A5\u72B6\u6001",value:ge,bordered:!0})}),y===V.FullFunction&&(0,e.jsx)(B.Z,{lg:3,md:8,sm:12,xs:24,children:(0,e.jsx)(Te,{title:"\u6FC0\u5149\u4F20\u611F\u5668",value:ge,bordered:!0})}),(0,e.jsx)(B.Z,{lg:3,md:8,sm:12,xs:24,children:(0,e.jsx)(Te,{title:"\u89C6\u89C9\u91CC\u7A0B\u8BA1",value:ge,bordered:!0})}),(0,e.jsx)(B.Z,{lg:3,md:8,sm:12,xs:24,children:(0,e.jsx)(Te,{title:"\u89C6\u9891\u6D41\u72B6\u6001",value:ge,bordered:!0})}),(0,e.jsx)(B.Z,{lg:3,md:8,sm:12,xs:24,children:(0,e.jsx)(Te,{title:"\u6DF1\u5EA6\u4F20\u611F\u5668",value:ge,bordered:!0})})]})]})]})}),(0,e.jsx)(Zr.Z,{title:"\u{1F590}\uFE0F \u8BBE\u5907\u81EA\u52A8\u914D\u5BF9\u5411\u5BFC",centered:!0,open:je,onCancel:function(){return!H&&oe(!1)},footer:[(0,e.jsx)(T.ZP,{onClick:function(){return oe(!1)},disabled:H,children:"\u53D6\u6D88"},"cancel"),(0,e.jsx)(T.ZP,{type:"primary",loading:H,onClick:bt,children:H?"\u6B63\u5728\u68C0\u6D4B...":"\u5F00\u59CB\u914D\u5BF9"},"submit")],children:(0,e.jsx)("div",{style:{padding:"20px 0"},children:H?(0,e.jsxs)("div",{style:{textAlign:"center"},children:[(0,e.jsx)(Lr.Z,{size:"large",tip:"\u6B63\u5728\u5206\u6790\u8FD0\u52A8\u6570\u636E..."}),(0,e.jsx)("div",{style:{marginTop:20,fontSize:16,fontWeight:"bold",color:"#1890ff"},children:"\u8BF7\u6301\u7EED\u6447\u6643 \u3010\u5DE6\u624B\u3011 \u8BBE\u5907\uFF01"}),(0,e.jsx)("div",{style:{marginTop:8,color:"#666"},children:"(\u82E5\u53EA\u68C0\u6D4B\u5230\u5355\u8BBE\u5907\uFF0C\u5C06\u81EA\u52A8\u8DF3\u8FC7\u6B64\u6B65\u9AA4)"})]}):(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{children:"\u6B64\u529F\u80FD\u5C06\u81EA\u52A8\u8BC6\u522B\u5DE6\u624B\u548C\u53F3\u624B\u8BBE\u5907\u3002"}),(0,e.jsxs)("div",{style:{background:"#f5f5f5",padding:15,borderRadius:8},children:[(0,e.jsx)("p",{children:(0,e.jsx)("strong",{children:"\u667A\u80FD\u914D\u5BF9\u903B\u8F91\uFF1A"})}),(0,e.jsxs)("ul",{children:[(0,e.jsxs)("li",{children:[(0,e.jsx)("strong",{children:"\u5355\u8BBE\u5907\u6A21\u5F0F\uFF1A"}),"\u82E5\u4EC5\u68C0\u6D4B\u5230\u4E00\u53F0\u8BBE\u5907\uFF0C\u81EA\u52A8\u5C06\u5176\u5206\u914D\u4E3A\u5DE6\u624B\u3002"]}),(0,e.jsxs)("li",{children:[(0,e.jsx)("strong",{children:"\u53CC\u8BBE\u5907\u6A21\u5F0F\uFF1A"}),"\u8BF7\u70B9\u51FB\u5F00\u59CB\u540E\uFF0C\u6447\u6643\u5DE6\u624B\u8BBE\u5907\u8FDB\u884C\u533A\u5206\u3002"]})]})]})]})})})]})},Hr=zr,Xe=function(r){return pe().isString(r)?r.length===0:pe().isObject(r)?pe().isEmpty(Object.keys(r)):pe().isArray(r)?pe().isEmpty(r.length):pe().isNil(r)},Ze="localhost",Le="8887",Ie="v0",$t="http://".concat(Ze,":").concat(Le,"/api/").concat(Ie),gn=function(r){var a=r.title,l=r.value,y=r.bordered,j=useStyles(),b=j.styles;return _jsxs("div",{className:b.headerInfo,children:[_jsx("span",{children:a}),_jsx("p",{children:l}),y&&_jsx("em",{})]})},Gr=function(){var r=(0,n.useState)(V.Portable),a=S()(r,2),l=a[0],y=a[1],j=(0,n.useState)([]),b=S()(j,2),c=b[0],D=b[1],Z=(0,n.useRef)(null),L=(0,n.useRef)(null),Q=(0,n.useRef)(null),I=(0,n.useRef)(null),z=(0,n.useRef)(0),se=(0,n.useState)("idle"),ie=S()(se,2),we=ie[0],ue=ie[1],Oe=(0,n.useState)(!1),J=S()(Oe,2),K=J[0],ae=J[1],We=(0,n.useState)(!1),me=S()(We,2),p=me[0],Se=me[1],Ne=(0,n.useState)(),he=S()(Ne,2),q=he[0],ye=he[1],Ye=(0,n.useState)(),De=S()(Ye,2),Ce=De[0],Ae=De[1],E=(0,n.useRef)(null),_=(0,n.useRef)(null),Ve=(0,n.useRef)(null),Ee=(0,n.useState)(null),je=S()(Ee,2),oe=je[0],ke=je[1],O=(0,n.useRef)(null),H=(0,n.useRef)(null),P=(0,n.useState)([]),ee=S()(P,2),Me=ee[0],Ke=ee[1],le=(0,n.useRef)(null),bt=(0,n.useState)(null),Je=S()(bt,2),qe=Je[0],ge=Je[1],W=(0,n.useRef)(null),ce=(0,n.useRef)(null),_e=(0,n.useState)(null),et=S()(_e,2),tt=et[0],be=et[1],Ft=(0,n.useState)(null),rt=S()(Ft,2),Bt=rt[0],nt=rt[1],xt=(0,n.useState)([]),at=S()(xt,2),Rt=at[0],st=at[1],Ut=(0,n.useState)([]),it=S()(Ut,2),Qt=it[0],f=it[1],h=(0,n.useRef)(0),v=(0,n.useRef)(null),s=(0,n.useRef)(null),m=(0,n.useRef)(null),t=(0,n.useRef)(null),N=(0,n.useRef)(null),d=(0,n.useState)(!1),ut=S()(d,2),u=ut[0],Yr=ut[1],Vr=(0,n.useState)(!1),zt=S()(Vr,2),wt=zt[0],Kr=zt[1],Jr=(0,n.useState)(!1),Ht=S()(Jr,2),$e=Ht[0],qr=Ht[1],_r=Ct(),Fe=_r.styles,Gt=(0,Pt.useRequest)(function(){return lr()}),pn=Gt.data,ot=Gt.loading,Ue=(0,n.useMemo)(function(){return function(k){var o,x,X,Y,te,R,M,$=k.timestamp,U=k.data||[],w=new Date($*1e3).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),G=[{id:"1",name:"\u5750\u6807X",value:((o=U[0])!==null&&o!==void 0?o:0).toFixed(4),time:w},{id:"2",name:"\u5750\u6807Y",value:((x=U[1])!==null&&x!==void 0?x:0).toFixed(4),time:w},{id:"3",name:"\u5750\u6807Z",value:((X=U[2])!==null&&X!==void 0?X:0).toFixed(4),time:w}],de=[{id:"1",name:"QX",value:((Y=U[3])!==null&&Y!==void 0?Y:0).toFixed(4),time:w},{id:"2",name:"QY",value:((te=U[4])!==null&&te!==void 0?te:0).toFixed(4),time:w},{id:"3",name:"QZ",value:((R=U[5])!==null&&R!==void 0?R:0).toFixed(4),time:w},{id:"4",name:"QW",value:((M=U[6])!==null&&M!==void 0?M:0).toFixed(4),time:w}];return{xyz:G,q:de}}},[]),lt=50,Xt=1,Yt=function(){E.current&&(E.current.onerror=null,E.current.src="")},en=(0,n.useState)(0),Vt=S()(en,2),tn=Vt[0],ct=Vt[1];(0,n.useEffect)(function(){if(!p){N.current&&(N.current.close(),N.current=null),ae(!1),ue("idle"),D([]),be(null),st([]),Z.current=null;return}var k="ws://".concat(Ze,":").concat(Le,"/api/").concat(Ie,"/ws/slam_stream"),o=new WebSocket(k);return N.current=o,ue("sse"),ae(!1),o.onopen=function(){console.log("SLAM WebSocket Connected"),ae(!0)},o.onmessage=function(x){try{var X=JSON.parse(x.data);X.type==="slam"&&(Z.current=X)}catch(Y){console.error("Failed to parse SLAM WebSocket message",Y)}},o.onerror=function(x){console.error("SLAM WebSocket Error:",x),C.ZP.error("SLAM WebSocket \u8FDE\u63A5\u5931\u8D25\u3002"),ae(!1)},o.onclose=function(){console.log("SLAM WebSocket Disconnected"),ae(!1),N.current=null},function(){o.readyState===WebSocket.OPEN&&o.close(),N.current=null}},[p,Ue]),(0,n.useEffect)(function(){if(!p){H.current&&(H.current.close(),H.current=null),O.current&&(URL.revokeObjectURL(O.current),O.current=null),ke(null),L.current=null;return}var k="ws://".concat(Ze,":").concat(Le,"/api/").concat(Ie,"/ws/tof_stream"),o=new WebSocket(k);return H.current=o,o.binaryType="arraybuffer",o.onopen=function(){console.log("TOF Image WebSocket Connected")},o.onmessage=function(x){L.current=x.data},o.onerror=function(x){console.error("TOF Image WebSocket Error:",x),C.ZP.error("TOF Image WebSocket \u8FDE\u63A5\u5931\u8D25\u3002")},o.onclose=function(){console.log("TOF Image WebSocket Disconnected"),H.current=null},function(){o.readyState===WebSocket.OPEN&&o.close(),H.current=null,O.current&&(URL.revokeObjectURL(O.current),O.current=null)}},[p]),(0,n.useEffect)(function(){if(!p){le.current&&(le.current.close(),le.current=null),Ke([]),nt(null),f([]),Q.current=null;return}var k="ws://".concat(Ze,":").concat(Le,"/api/").concat(Ie,"/ws/right_slam_stream"),o=new WebSocket(k);return le.current=o,o.onopen=function(){console.log("Right SLAM WebSocket Connected")},o.onmessage=function(x){try{var X=JSON.parse(x.data);Q.current=X}catch(Y){console.error("Failed to parse Right SLAM WebSocket message",Y)}},o.onerror=function(x){console.error("Right SLAM WebSocket Error:",x),C.ZP.error("Right SLAM WebSocket \u8FDE\u63A5\u5931\u8D25\u3002")},o.onclose=function(){console.log("Right SLAM WebSocket Disconnected"),le.current=null},function(){o.readyState===WebSocket.OPEN&&o.close(),le.current=null}},[p,Ue]),(0,n.useEffect)(function(){if(!p){ce.current&&(ce.current.close(),ce.current=null),W.current&&(URL.revokeObjectURL(W.current),W.current=null),ge(null),I.current=null;return}var k="ws://".concat(Ze,":").concat(Le,"/api/").concat(Ie,"/ws/right_tof_stream"),o=new WebSocket(k);return ce.current=o,o.binaryType="arraybuffer",o.onopen=function(){console.log("Right TOF Image WebSocket Connected")},o.onmessage=function(x){I.current=x.data},o.onerror=function(x){console.error("Right TOF Image WebSocket Error:",x),C.ZP.error("Right TOF Image WebSocket \u8FDE\u63A5\u5931\u8D25\u3002")},o.onclose=function(){console.log("Right TOF Image WebSocket Disconnected"),ce.current=null},function(){o.readyState===WebSocket.OPEN&&o.close(),ce.current=null,W.current&&(URL.revokeObjectURL(W.current),W.current=null)}},[p]),(0,n.useEffect)(function(){var k=function(){var Y=re()(A()().mark(function te(R,M,$,U){var w,G,de,Qe;return A()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(!M.current){F.next=3;break}return console.log("[WebRTC ".concat(R,"] Already connected.")),F.abrupt("return");case 3:return console.log("[WebRTC ".concat(R,"] 1. Creating PeerConnection")),w=new RTCPeerConnection,M.current=w,w.ontrack=function(dt){console.log("[WebRTC ".concat(R,"] 4. Received remote track")),$.current&&dt.streams[0]&&($.current.srcObject=dt.streams[0],console.log("[WebRTC ".concat(R,"] 5. Attached track to <video> element")))},w.onconnectionstatechange=function(){console.log("[WebRTC ".concat(R,"] Connection state: ").concat(w.connectionState)),(w.connectionState==="failed"||w.connectionState==="closed"||w.connectionState==="disconnected")&&o(R,M,$)},F.prev=8,w.addTransceiver("video",{direction:"recvonly"}),console.log("[WebRTC ".concat(R,"] 2. Creating Offer")),F.next=13,w.createOffer();case 13:return G=F.sent,F.next=16,w.setLocalDescription(G);case 16:return console.log("[WebRTC ".concat(R,"] 3. Sending Offer to server...")),F.next=19,fetch(U,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sdp:G.sdp,type:G.type})});case 19:if(de=F.sent,de.ok){F.next=22;break}throw new Error("Server responded with ".concat(de.status));case 22:return F.next=24,de.json();case 24:return Qe=F.sent,console.log("[WebRTC ".concat(R,"] 6. Received server Answer")),F.next=28,w.setRemoteDescription(new RTCSessionDescription(Qe));case 28:console.log("[WebRTC ".concat(R,"] 7. Set remote Answer. Connection established!")),F.next=36;break;case 31:F.prev=31,F.t0=F.catch(8),console.error("[WebRTC ".concat(R,"] Failed to start:"),F.t0),C.ZP.error("WebRTC (".concat(R,") connection failed: ").concat(F.t0.message)),o(R,M,$);case 36:case"end":return F.stop()}},te,null,[[8,31]])}));return function(R,M,$,U){return Y.apply(this,arguments)}}(),o=function(te,R,M){var $=R.current;$&&(console.log("[WebRTC ".concat(te,"] Stopping connection...")),$.close(),R.current=null),M.current&&(M.current.srcObject=null)};if(p){var x=window.location.hostname,X=$t||"http://".concat(x,":8887/api/v0");Xe(q)||k("left",v,m,"".concat(X,"/webrtc/offer/left")),Xe(Ce)||k("right",s,t,"".concat(X,"/webrtc/offer/right"))}return function(){o("left",v,m),o("right",s,t)}},[p]),(0,n.useEffect)(function(){if(p){var k,o=function x(){z.current+=1;var X=1,Y=z.current%X===0;if(Z.current){var te=Z.current,R={timestamp:te.timestamp,data:te.data},M=Ue(R),$=M.xyz,U=M.q,w=[{X:$[0].value,Y:$[1].value,Z:$[2].value,QX:U[0].value,QY:U[1].value,QZ:U[2].value,QW:U[3].value,time:$[0].time}],G=w[0],de=new ve.Pa4(parseFloat(G.Y||"0"),parseFloat(G.Z||"0"),parseFloat(G.X||"0")),Qe=new ve._fP(parseFloat(G.QX||"0"),parseFloat(G.QY||"0"),parseFloat(G.QZ||"0"),parseFloat(G.QW||"1"));if(be({position:de,quaternion:Qe}),Y&&D(w),h.current+=1,h.current%Xt===0){var Jt={position:de,quaternion:Qe};st(function(Dt){return[].concat(Et()(Dt),[Jt]).slice(-lt)})}Z.current=null}if(Q.current){var F=Q.current,dt={timestamp:F.timestamp,data:F.data},qt=Ue(dt),ft=qt.xyz,vt=qt.q,_t=[{X:ft[0].value,Y:ft[1].value,Z:ft[2].value,QX:vt[0].value,QY:vt[1].value,QZ:vt[2].value,QW:vt[3].value,time:ft[0].time}],Be=_t[0],er=new ve.Pa4(parseFloat(Be.Y||"0"),parseFloat(Be.Z||"0"),parseFloat(Be.X||"0")),tr=new ve._fP(parseFloat(Be.QX||"0"),parseFloat(Be.QY||"0"),parseFloat(Be.QZ||"0"),parseFloat(Be.QW||"1"));if(nt({position:er,quaternion:tr}),Y&&Ke(_t),h.current+=1,h.current%Xt===0){var an={position:er,quaternion:tr};f(function(Dt){return[].concat(Et()(Dt),[an]).slice(-lt)})}Q.current=null}if(L.current&&!Xe(q)){var sn=new Blob([L.current],{type:"image/jpeg"}),rr=URL.createObjectURL(sn);ke(rr),O.current&&URL.revokeObjectURL(O.current),O.current=rr,L.current=null}if(I.current&&!Xe(Ce)){var un=new Blob([I.current],{type:"image/jpeg"}),nr=URL.createObjectURL(un);ge(nr),W.current&&URL.revokeObjectURL(W.current),W.current=nr,I.current=null}k=requestAnimationFrame(x)};return k=requestAnimationFrame(o),function(){cancelAnimationFrame(k),O.current&&URL.revokeObjectURL(O.current),W.current&&URL.revokeObjectURL(W.current)}}},[p,Ue]),(0,n.useEffect)(function(){if(p)p&&!u?ct(1):p&&u&&ct(2);else{Yt(),ct(0);return}return function(){Yt()}},[p,u]);var Kt=[{title:"\u65F6\u95F4",dataIndex:"time",key:"time",align:"left"},{title:"\u5750\u6807X",dataIndex:"X",key:"X",align:"left"},{title:"\u5750\u6807Y",dataIndex:"Y",key:"Y",align:"left"},{title:"\u5750\u6807Z",dataIndex:"Z",key:"Z",align:"left"},{title:"QX",dataIndex:"QX",key:"QX",align:"left"},{title:"QY",dataIndex:"QY",key:"QY",align:"left"},{title:"QZ",dataIndex:"QZ",key:"QZ",align:"left"},{title:"QW",dataIndex:"QW",key:"QW",align:"left"}],mn=function(){console.log("Abnormal Stop button clicked"),C.ZP.error("\u6267\u884C\u5F02\u5E38\u505C\u6B62\uFF01")},rn=(0,e.jsxs)("div",{children:[$e===!1&&(0,e.jsxs)("div",{children:["\u8BBE\u5907\u72B6\u6001\uFF1A\u505C\u6B62 ",(0,e.jsx)(Tt.Z,{status:"error"})]}),$e===!0&&(0,e.jsxs)("div",{children:["\u8BBE\u5907\u72B6\u6001\uFF1A\u6B63\u5E38 ",(0,e.jsx)(Tt.Z,{status:"success"})]})]}),nn=(0,n.useMemo)(function(){return p||ot||$e||wt},[p,ot,$e,wt]);return(0,e.jsx)(Rr,{value:{},children:(0,e.jsxs)(or._z,{title:rn,children:[(0,e.jsx)(xr,{disabled:nn,value:l,onChange:function(o){y(o)}}),(0,e.jsx)(Hr,{version:l,connect:p,connMode:we,connOk:K,isStarting:wt,deviceStarted:$e,recording:u,currentStep:tn,setConnect:Se,setConnMode:ue,setConnOk:ae,setIsStarting:Kr,setDeviceStarted:qr,setRecording:Yr,setVersion:y,leftSN:q,setLeftSN:ye,rightSN:Ce,setRightSN:Ae,setCurrentStep:ct}),(0,e.jsxs)(fe.Z,{title:"\u53EF\u89C6\u5316\u533A\u57DF",variant:"borderless",style:{marginTop:8},children:[(0,e.jsx)(fe.Z,{variant:"borderless",style:{marginTop:0},bodyStyle:{padding:0},children:(0,e.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",columnGap:0,rowGap:0,gap:24,alignItems:"start"},children:[(0,e.jsxs)(fe.Z,{variant:"borderless",style:{marginTop:0},bodyStyle:{padding:0},children:[(0,e.jsx)(ze.Z,{title:"\u5DE6\u624B-RGB",size:"small",style:{marginBottom:0},styles:{header:{marginBottom:8,padding:"0 8px"},content:{margin:0,padding:0}},children:(0,e.jsxs)("div",{style:{width:"100%",paddingTop:"56.25%",backgroundColor:"black",position:"relative"},children:[(0,e.jsx)("video",{ref:m,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"contain",display:p?"block":"none"}}),!p&&(0,e.jsx)("div",{className:Fe.loadingMask,children:(0,e.jsxs)("span",{style:{fontSize:15},children:["\u672A\u8FDE\u63A5.... ",(0,e.jsx)("br",{})," \u70B9\u51FB\u4E0A\u65B9 \u201C\u8FDE\u63A5\u8BBE\u5907\u201D \u5F00\u59CB\u89C6\u9891\u6D41"]})})]})}),(0,e.jsx)(ze.Z,{title:"\u5DE6\u624B-TOF",size:"small",style:{marginBottom:0},styles:{header:{marginBottom:8,padding:"0 8px"},content:{margin:0,padding:0}},children:(0,e.jsx)("div",{style:{width:"100%",paddingTop:"56.25%",backgroundColor:"black",position:"relative"},children:p&&oe?(0,e.jsx)("img",{alt:"video-1-bottom",src:oe,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"contain",backgroundColor:"black",display:"block"}}):(0,e.jsx)("div",{className:Fe.loadingMask,children:(0,e.jsx)("span",{style:{fontSize:15},children:p?"\u7B49\u5F85\u89C6\u9891\u6D41...":"\u672A\u8FDE\u63A5.... \u70B9\u51FB\u4E0A\u65B9 \u201C\u8FDE\u63A5\u8BBE\u5907\u201D \u5F00\u59CB\u89C6\u9891\u6D41"})})})})]}),(0,e.jsxs)(fe.Z,{variant:"borderless",style:{marginTop:0},bodyStyle:{padding:0},children:[(0,e.jsx)(ze.Z,{title:"\u53F3\u624B-RGB",size:"small",style:{marginBottom:0},styles:{header:{marginBottom:8,padding:"0 8px"},content:{margin:0,padding:0}},children:(0,e.jsxs)("div",{style:{width:"100%",paddingTop:"56.25%",backgroundColor:"black",position:"relative"},children:[(0,e.jsx)("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"contain",display:p?"block":"none"}}),!p&&(0,e.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"white",lineHeight:"1.5",textAlign:"center"},children:(0,e.jsxs)("span",{style:{fontSize:15},children:["\u672A\u8FDE\u63A5.... ",(0,e.jsx)("br",{})," \u70B9\u51FB\u4E0A\u65B9 \u201C\u8FDE\u63A5\u8BBE\u5907\u201D \u5F00\u59CB\u89C6\u9891\u6D41"]})})]})}),(0,e.jsx)(ze.Z,{title:"\u53F3\u624B-TOF",size:"small",style:{marginBottom:0},styles:{header:{marginBottom:8,padding:"0 8px"},content:{margin:0,padding:0}},children:(0,e.jsx)("div",{style:{width:"100%",paddingTop:"56.25%",backgroundColor:"black",position:"relative"},children:p&&qe?(0,e.jsx)("img",{src:qe,alt:"video-3-bottom",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"contain",backgroundColor:"black",display:"block"}}):(0,e.jsx)("div",{className:Fe.loadingMask,children:(0,e.jsx)("span",{style:{fontSize:15},children:p?"\u7B49\u5F85\u89C6\u9891\u6D41...":"\u672A\u8FDE\u63A5.... \u70B9\u51FB\u4E0A\u65B9 \u201C\u8FDE\u63A5\u8BBE\u5907\u201D \u5F00\u59CB\u89C6\u9891\u6D41"})})})})]})]})}),(0,e.jsxs)(xe.Z,{gutter:24,children:[(0,e.jsxs)(B.Z,{span:12,children:[(0,e.jsx)("div",{className:Fe.title,style:{marginTop:24},children:"\u5DE6\u624BSLAM 3D\u4F4D\u59FF"}),(0,e.jsx)(fe.Z,{style:{height:400,marginBottom:24,padding:0},styles:{body:{padding:0,height:"100%"}},children:(0,e.jsx)(Lt,{currentPose:tt,history:Rt,trajectoryLength:lt})}),(0,e.jsx)("div",{className:Fe.title,style:{marginTop:24},children:"\u5DE6\u624BSLAM \u6570\u636E"}),(0,e.jsx)(kt.Z,{style:{marginBottom:24,width:"100%"},pagination:!1,search:!1,loading:ot,options:!1,toolBarRender:!1,dataSource:c,columns:Kt,rowKey:"time"})]}),(0,e.jsxs)(B.Z,{span:12,children:[(0,e.jsx)("div",{className:Fe.title,style:{marginTop:24},children:"\u53F3\u624BSLAM 3D\u4F4D\u59FF"}),(0,e.jsx)(fe.Z,{style:{height:400,marginBottom:24,padding:0},styles:{body:{padding:0,height:"100%"}},children:(0,e.jsx)(Lt,{currentPose:Bt,history:Qt,trajectoryLength:lt})}),(0,e.jsx)("div",{className:Fe.title,style:{marginTop:24},children:"\u53F3\u624BSLAM \u6570\u636E"}),(0,e.jsx)(kt.Z,{style:{marginBottom:24,width:"100%"},pagination:!1,search:!1,loading:ot,options:!1,toolBarRender:!1,dataSource:Me,columns:Kt,rowKey:"time"})]})]})]})]})})},Xr=Gr}}]);
